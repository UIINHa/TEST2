#include <windows.h>
#include <iostream>
#include <iomanip>

int main() {
    HWND hwnd = FindWindowA(NULL, "AssaultCube");
    if (!hwnd) {
        std::cout << "AssaultCube 실행 중인지 확인하세요.\n";
        return 1;
    }

    DWORD pid = 0;
    GetWindowThreadProcessId(hwnd, &pid);

    HANDLE hProc = OpenProcess(PROCESS_VM_READ | PROCESS_QUERY_INFORMATION, FALSE, pid);
    if (!hProc) {
        std::cout << "프로세스 열기 실패\n";
        return 1;
    }

    // Z 좌표 주소와 탄약 주소 (float, int)
    float x = 0.0f, y = 0.0f, z = 0.0f;
    int ammo = 0;

    // 실제 좌표를 담고 있는 정적 주소들 (직접 Cheat Engine으로 검증 필요)
    uintptr_t zAddr    = 0x00FEA254;
    uintptr_t yAddr    = 0x00FEA250;
    uintptr_t xAddr    = 0x00FEA24C;
    uintptr_t ammoAddr = 0x00FEA398;

    // 메모리 읽기
    ReadProcessMemory(hProc, (LPCVOID)xAddr, &x, sizeof(float), NULL);
    ReadProcessMemory(hProc, (LPCVOID)yAddr, &y, sizeof(float), NULL);
    ReadProcessMemory(hProc, (LPCVOID)zAddr, &z, sizeof(float), NULL);
    ReadProcessMemory(hProc, (LPCVOID)ammoAddr, &ammo, sizeof(int), NULL);

    std::cout << std::fixed << std::setprecision(2);
    std::cout << "내 위치:\n";
    std::cout << "  X = " << x << "\n";
    std::cout << "  Y = " << y << "\n";
    std::cout << "  Z = " << z << "\n\n";
    std::cout << "탄약 수: " << ammo << "\n";

    CloseHandle(hProc);
    return 0;
}
